{% extends "base_admin.html" %}

{% block admin_content %}
    <div style="max-width: 650px; margin: 20px auto; padding: 25px; border: 1px solid #007bff; border-radius: 8px; background-color: #f9f9f9;">
        <h2 style="text-align: center; color: #007bff;">Chỉnh sửa Hồ sơ Nhân viên</h2>
        <h4 style="text-align: center; margin-bottom: 20px;">ID: {{ staff.id }} - Username: {{ staff.username }}</h4>
        <hr>
        
        {% if error %}
            <div style="color: white; background-color: #dc3545; padding: 10px; border-radius: 4px; text-align: center; margin-bottom: 15px;">{{ error }}</div>
        {% endif %}
        
        <form method="POST" action="{% url 'users:admin_edit_staff' staff_id=staff.id %}">
            {% csrf_token %}
            
            {% if staff %}
                <h5 style="margin-top: 20px; color: #333;">Thông tin Cơ bản:</h5>

                <label for="username" style="display: block; margin-bottom: 5px; font-weight: bold;">Tên đăng nhập:</label>
                <input type="text" id="username" name="username" 
                       value="{{ staff.username }}" 
                       style="width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px;" required>

                <label for="gender" style="display: block; margin-bottom: 5px; font-weight: bold;">Giới tính:</label>
                <select id="gender" name="gender" 
                        style="width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px;" required>
                    <option value="Male" {% if staff.gender == 'Male' %}selected{% endif %}>Nam</option>
                    <option value="Female" {% if staff.gender == 'Female' %}selected{% endif %}>Nữ</option>
                    <option value="Other" {% if staff.gender == 'Other' %}selected{% endif %}>Khác</option>
                </select>

                <label for="birth_date" style="display: block; margin-bottom: 5px; font-weight: bold;">Ngày sinh:</label>
                <input type="date" id="birth_date" name="birth_date" 
                       value="{{ staff.birth_date|date:'Y-m-d' }}" 
                       style="width: 100%; padding: 10px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 4px;" required>
                
                <div style="margin-bottom: 20px; color: #555;">
                    <strong>Ngày vào làm:</strong> {{ staff.start_date|date:'d/m/Y' }} (Không thể sửa)
                </div>

                <h5 style="margin-top: 20px; color: #333; border-top: 1px dashed #ddd; padding-top: 15px;">Thông tin Lương:</h5>
                <label for="salary_id" style="display: block; margin-bottom: 5px; font-weight: bold;">Bậc lương hiện tại:</label>
                <select id="salary_id" name="salary_id" 
                        style="width: 100%; padding: 10px; margin-bottom: 25px; border: 1px solid #ccc; border-radius: 4px;" required>
                    {% for rank in salary_ranks %}
                        <option value="{{ rank.salary_id }}" 
                            {% if rank.salary_id == staff.salary_id %}selected{% endif %}>
                            {{ rank.rank }} (Lương cơ bản: {{ rank.amount|floatformat:0 }} VNĐ)
                        </option>
                    {% empty %}
                        <option value="">Không có bậc lương nào</option>
                    {% endfor %}
                </select>

                <button type="submit" 
                        style="background-color: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; display: block; width: 100%;">
                    Lưu Thay Đổi (Cập nhật hồ sơ và Log lương)
                </button>
            {% else %}
                <p style="text-align: center;">Không tìm thấy dữ liệu nhân viên để chỉnh sửa.</p>
            {% endif %}

        </form>
        
        <a href="{% url 'users:list_staff' %}" style="display: block; text-align: center; margin-top: 20px; color: #555; text-decoration: none;">
            ← Hủy và Quay lại Danh sách
        </a>
    </div>
{% endblock admin_content %}